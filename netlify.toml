[build]
  # Frontend static site deployment
  publish = "frontend"
  command = "echo 'No build process needed for static frontend'"
  ignore = "exit 0"

[build.environment]
  # Environment settings
  NETLIFY_SKIP_YARN_INTEGRITY_CHECK = "1"
  NODE_VERSION = "18"

# Plugin to install function dependencies
[[plugins]]
  package = "@netlify/plugin-functions-install-core"

# Environment variables for Netlify Functions
[context.production.environment]
  FIREBASE_PROJECT_ID = "edenwebsite-e149c"
  FIREBASE_PRIVATE_KEY_ID = "1722098108a15baa8c2bd0035c3ca90082702c4d"
  FIREBASE_PRIVATE_KEY = "-----BEGIN PRIVATE KEY-----\nMIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQDstUpx8rZAMpWu\nLxJQN9L8GuyVacqZk83wQLHo2cWmKBymUXxnF724ZyZENYd3F1A2hdzB/fEy+Jp+\nsrJXPi5ouXrN45LjTEY5k1fppR64JBgguXy4xFFKxepn4wnbNwXGbjxppgp/Eu+k\nqy7w+QF0RVbj3TVy4VV+hgC2fLJHeIcwa2NvgNajiq5Hg8aq7PlXKgV60othuUtL\nXLItLqRamMMRydqeBJibDRnpQy3Ts5aOmHc53nAD+TIUelSplWVhVSrKfWWk1Vgv\nAuYgEQ5+hrNSDknbhfc85PEIIgJRwvI4gB/rZPacxj38gI6+QD+qCOINFA54irRQ\nqCwC0U2vAgMBAAECggEAcpl+1lYMuF4FK5RsiFvOkPG0Es5qIRp2/NdFixdL4prO\n7BLNaNgMqSd/VkyYLiciVZNPgrggO24y1h5Ly4M2Usth0iZYqiT2Zs+YI20mxz3q\nVIWZBZc+SDYzu2InFnO4Hw6lvvx9XnJbhVy/WDkl5BXh8GXbh6fijWPxGmiao5Cf\nZ2oEyHUC99s8trtYzuBfIGcxoD8Y9zHb+ZYzN3H1h1IEVXPE3+4vU3N/q0VSx+OB\nQuySv2fbGAnTmjn0LItmEMHIa+0kI9OGrr+1LXOgy/mHb+1+3hzBpxPXyBWC8wcv\nZthU+sj+V0X8rk9y2msbhhaGeCmM5rc+WsltREqtSQKBgQD9Exn+P5mtDSbpLLwQ\nDvfxnzGP3m7Rbnd1BAoOmLzSlRS3lTPKgnRMH0TPXtWnU7UPPovJ9duonU3+0Nm1\nsZKI255M7F9wRX5FuT9DFX1XHIO5As7zFKxKC/aGhSD51At3eDB4oc4/ht45o0Cv\nFHvhna2vNqaGnp8SZP3pCIyC5QKBgQDvccH2hrIV5tyQeaOUOF5KH2+rMnqVDSht\nsX4WqUqwMFw6/0zje/KLc6KBl8G770+Iiy8CnNSJCKINvOoD7Hwn3wYcwzqTiT/t\nk9Trejx2o0HwjzCAwmpuq8aTZxGxqddg0cHMKrYh2gMxBUPmAYS9slyZFP1Q2vnp\nsjhotRdhAwKBgAx5CojrXYmX4lkPqV0pP7Ma43hxwAh2Z1DPGCfMA1JlopXBtsG+\nWDkAOYX26JTMnVnY/U7A3UicKCHs7S31SIGSQWUNKU8BPc316VZHEtxePWe66bQ1\nSqCDomzS1uM5Pi9vLwRjBSVAYmd40lFOsyRVfx/pk5+C5dgkPhdkIni5AoGBAOn/\nM9xl+bdpq3cNSIzbIVoyqoCVjjIHb9DzOhOPUcwpFpkZUdymDnu1f8RBuDSfRAxe\naIyXEyTv6N6gFdnLy/FzBJgrOh1gbbcRV2zgQiJ2nUQnyvCqDjUlbaQzf5kuL6sQ\nkeGig+dFFQVc7ePi7AQuQEvhtUTFGqIFZxb8kmJdAoGBAJzBe1t0qMSHAW0FaHQy\ntqu0ijmW+CgiPXz4TY/DzhGd3rQIwUF8PUID1ZnAsT1Ie45UGYCiBXlJWzUTFE+R\nMg5GO5JQ4DDQ3sw9lUdokfNwRlBPpLvgxF/08Y9CSGZZou6gAhdvU69SStEQcUHC\nrDG733Lu7kqPzhWTjNL4BCeG\n-----END PRIVATE KEY-----\n"
  FIREBASE_CLIENT_EMAIL = "firebase-adminsdk-fbsvc@edenwebsite-e149c.iam.gserviceaccount.com"
  FIREBASE_CLIENT_ID = "111538205791379133511"
  FIREBASE_CLIENT_X509_CERT_URL = "https://www.googleapis.com/robot/v1/metadata/x509/firebase-adminsdk-fbsvc%40edenwebsite-e149c.iam.gserviceaccount.com"

# Netlify Functions for API
[functions]
  directory = "netlify/functions"

# API redirects to Netlify Functions
[[redirects]]
  from = "/api/v2/auth/login"
  to = "/.netlify/functions/auth-login"
  status = 200

[[redirects]]
  from = "/api/v2/auth/verify"
  to = "/.netlify/functions/auth-verify"
  status = 200

[[redirects]]
  from = "/api/v2/auth/logout"
  to = "/.netlify/functions/auth-logout"
  status = 200

[[redirects]]
  from = "/api/v2/perfumes"
  to = "/.netlify/functions/perfumes"
  status = 200

[[redirects]]
  from = "/api/v2/brands"
  to = "/.netlify/functions/brands"
  status = 200

[[redirects]]
  from = "/api/v2/photos/*"
  to = "/.netlify/functions/photos"
  status = 200

[[redirects]]
  from = "/api/v2/errors"
  to = "/.netlify/functions/errors"
  status = 200

[[redirects]]
  from = "/api/social/analytics"
  to = "/.netlify/functions/social-analytics"
  status = 200

# Specific page redirects (exclude from catch-all)
[[redirects]]
  from = "/catalog.html"
  to = "/catalog.html"
  status = 200
  force = true

[[redirects]]
  from = "/perfume-detail.html"
  to = "/perfume-detail.html"
  status = 200
  force = true

[[redirects]]
  # Handle SPA routing - redirect all other requests to index.html
  from = "/*"
  to = "/index.html"
  status = 200
  force = false

# Security headers
[[headers]]
  for = "/*"
  [headers.values]
    X-Frame-Options = "DENY"
    X-XSS-Protection = "1; mode=block"
    X-Content-Type-Options = "nosniff"
    Referrer-Policy = "strict-origin-when-cross-origin"

# Cache static assets
[[headers]]
  for = "/photos/*"
  [headers.values]
    Cache-Control = "public, max-age=31536000"

[[headers]]
  for = "*.js"
  [headers.values]
    Cache-Control = "public, max-age=31536000"

[[headers]]
  for = "*.css"
  [headers.values]
    Cache-Control = "public, max-age=31536000"
