<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Social Media Integration Test - EDEN PARFUM</title>
    <link rel="stylesheet" href="css/social-integration.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body {
            font-family: 'Montserrat', sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background: #f8f9fa;
        }
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        .test-section {
            margin-bottom: 40px;
            padding: 20px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
        }
        .test-section h2 {
            color: #a58b4c;
            margin-bottom: 20px;
        }
        .test-results {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
        }
        .test-button {
            background: #a58b4c;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            margin: 5px;
            font-weight: 600;
        }
        .test-button:hover {
            background: #8b7355;
        }
        .status {
            font-weight: bold;
            padding: 5px 10px;
            border-radius: 5px;
            margin: 5px 0;
        }
        .status.pass {
            background: #d4edda;
            color: #155724;
        }
        .status.fail {
            background: #f8d7da;
            color: #721c24;
        }
        .status.pending {
            background: #fff3cd;
            color: #856404;
        }
        .demo-content {
            background: linear-gradient(135deg, #a58b4c, #8b7355);
            color: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            margin: 20px 0;
        }
        .api-test {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            border-left: 4px solid #a58b4c;
        }
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .feature-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #e9ecef;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }
        .feature-card h4 {
            color: #a58b4c;
            margin-bottom: 10px;
        }
        .test-log {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            max-height: 200px;
            overflow-y: auto;
            margin-top: 15px;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1 style="text-align: center; color: #a58b4c; margin-bottom: 40px;">
            <i class="fas fa-flask"></i> EDEN PARFUM Social Media Integration Test Suite
        </h1>

        <!-- Demo Content for Testing -->
        <div class="demo-content">
            <h2>Demo Perfume: Marc Jacobs Decadence</h2>
            <p>Premium fragrance testing content for social media integration validation</p>
        </div>

        <!-- Test Section 1: Floating Social Bar -->
        <div class="test-section">
            <h2><i class="fas fa-rocket"></i> Floating Social Media Bar Test</h2>
            <p>This test validates the floating social media bar functionality and appearance.</p>
            
            <button class="test-button" onclick="testFloatingSocialBar()">Test Floating Bar</button>
            <button class="test-button" onclick="toggleSocialBarVisibility()">Toggle Visibility</button>
            
            <div class="test-results" id="floatingBarResults">
                <div class="status pending">Status: Waiting for test...</div>
            </div>
        </div>

        <!-- Test Section 2: Social Share Buttons -->
        <div class="test-section">
            <h2><i class="fas fa-share-alt"></i> Social Share Buttons Test</h2>
            <p>Testing the social share button generation and functionality.</p>
            
            <!-- This will be populated by JavaScript -->
            <div class="eden-social-share">
                <div class="social-share-header">
                    <div class="share-icon">
                        <i class="fas fa-share-alt"></i>
                    </div>
                    <div class="share-content">
                        <h3>Test Social Sharing</h3>
                        <p>Share this test page to validate functionality</p>
                    </div>
                </div>
                <div class="social-share-buttons" id="testShareButtons">
                    <!-- Social share buttons will be dynamically generated -->
                </div>
            </div>

            <button class="test-button" onclick="testSocialSharing()">Test Share Buttons</button>
            
            <div class="test-results" id="shareButtonResults">
                <div class="status pending">Status: Waiting for test...</div>
            </div>
        </div>

        <!-- Test Section 3: Instagram & TikTok Guides -->
        <div class="test-section">
            <h2><i class="fab fa-instagram"></i> <i class="fab fa-tiktok"></i> Social Media Guides Test</h2>
            <p>Testing Instagram and TikTok content creation guides.</p>
            
            <div class="feature-grid">
                <div class="feature-card">
                    <h4><i class="fab fa-instagram"></i> Instagram Guide</h4>
                    <button class="test-button" onclick="testInstagramGuide()">Test Instagram Guide</button>
                    <div id="instagramGuideStatus" class="status pending">Not tested</div>
                </div>
                <div class="feature-card">
                    <h4><i class="fab fa-tiktok"></i> TikTok Guide</h4>
                    <button class="test-button" onclick="testTikTokGuide()">Test TikTok Guide</button>
                    <div id="tiktokGuideStatus" class="status pending">Not tested</div>
                </div>
            </div>
        </div>

        <!-- Test Section 4: Analytics Tracking -->
        <div class="test-section">
            <h2><i class="fas fa-chart-line"></i> Analytics Tracking Test</h2>
            <p>Testing social media analytics and event tracking.</p>
            
            <button class="test-button" onclick="testAnalyticsTracking()">Test Analytics</button>
            <button class="test-button" onclick="simulateUserInteraction()">Simulate User Events</button>
            <button class="test-button" onclick="checkAnalyticsData()">Check Analytics Data</button>
            
            <div class="test-results" id="analyticsResults">
                <div class="status pending">Status: Waiting for test...</div>
            </div>
        </div>

        <!-- Test Section 5: Backend API -->
        <div class="test-section">
            <h2><i class="fas fa-server"></i> Backend API Test</h2>
            <p>Testing backend API endpoints for social media functionality.</p>
            
            <div class="api-test">
                <h4>API Endpoints to Test:</h4>
                <ul>
                    <li>GET /api/social/analytics</li>
                    <li>POST /api/social/analytics/track</li>
                    <li>GET /api/social/share-counts</li>
                    <li>GET /api/social/trending</li>
                    <li>POST /api/social/engagement/log</li>
                    <li>GET /api/social/dashboard</li>
                </ul>
            </div>
            
            <button class="test-button" onclick="testAPIEndpoints()">Test All APIs</button>
            <button class="test-button" onclick="testShareCounts()">Test Share Counts</button>
            <button class="test-button" onclick="testAnalyticsAPI()">Test Analytics API</button>
            
            <div class="test-results" id="apiResults">
                <div class="status pending">Status: Waiting for test...</div>
            </div>
        </div>

        <!-- Test Section 6: Responsive Design -->
        <div class="test-section">
            <h2><i class="fas fa-mobile-alt"></i> Responsive Design Test</h2>
            <p>Testing mobile and tablet responsiveness of social media components.</p>
            
            <button class="test-button" onclick="testResponsiveDesign()">Test Responsive Design</button>
            <button class="test-button" onclick="simulateMobileView()">Simulate Mobile</button>
            <button class="test-button" onclick="simulateTabletView()">Simulate Tablet</button>
            
            <div class="test-results" id="responsiveResults">
                <div class="status pending">Status: Waiting for test...</div>
            </div>
        </div>

        <!-- Test Console Log -->
        <div class="test-section">
            <h2><i class="fas fa-terminal"></i> Test Console</h2>
            <p>Real-time test output and system logs.</p>
            
            <button class="test-button" onclick="clearTestLog()">Clear Log</button>
            <button class="test-button" onclick="runAllTests()">Run All Tests</button>
            
            <div class="test-log" id="testLog">
                <div>Social Media Integration Test Suite Initialized</div>
                <div>Ready to run tests...</div>
            </div>
        </div>

        <!-- Overall Test Summary -->
        <div class="test-section">
            <h2><i class="fas fa-clipboard-check"></i> Test Summary</h2>
            <div id="testSummary">
                <div class="status pending">Tests not yet run</div>
            </div>
        </div>
    </div>

    <!-- Include Social Integration JavaScript -->
    <script src="js/socialIntegration.js"></script>
    
    <!-- Test Suite JavaScript -->
    <script>
        // Test suite variables
        let testResults = {
            floatingBar: null,
            shareButtons: null,
            instagramGuide: null,
            tiktokGuide: null,
            analytics: null,
            api: null,
            responsive: null
        };

        // Utility function to log test results
        function logTest(message, type = 'info') {
            const log = document.getElementById('testLog');
            const timestamp = new Date().toLocaleTimeString();
            const logClass = type === 'error' ? 'color: #ff6b6b;' : type === 'success' ? 'color: #51cf66;' : 'color: #74c0fc;';
            log.innerHTML += `<div style="${logClass}">[${timestamp}] ${message}</div>`;
            log.scrollTop = log.scrollHeight;
        }

        function updateStatus(elementId, status, message) {
            const element = document.getElementById(elementId);
            element.className = `status ${status}`;
            element.textContent = message;
        }

        // Test 1: Floating Social Bar
        function testFloatingSocialBar() {
            logTest('Testing floating social bar...', 'info');
            
            try {
                if (window.edenSocial && window.edenSocial.floatingBar) {
                    testResults.floatingBar = true;
                    updateStatus('floatingBarResults', 'pass', 'Floating social bar is working correctly');
                    logTest('✓ Floating social bar test passed', 'success');
                } else {
                    testResults.floatingBar = false;
                    updateStatus('floatingBarResults', 'fail', 'Floating social bar not found');
                    logTest('✗ Floating social bar test failed', 'error');
                }
            } catch (error) {
                testResults.floatingBar = false;
                updateStatus('floatingBarResults', 'fail', `Error: ${error.message}`);
                logTest(`✗ Floating social bar error: ${error.message}`, 'error');
            }
        }

        function toggleSocialBarVisibility() {
            if (window.edenSocial && window.edenSocial.floatingBar) {
                window.edenSocial.floatingBar.classList.toggle('expanded');
                logTest('Toggled floating social bar visibility', 'info');
            }
        }

        // Test 2: Social Share Buttons
        function testSocialSharing() {
            logTest('Testing social share buttons...', 'info');
            
            try {
                const shareContainer = document.getElementById('testShareButtons');
                if (window.edenSocial && typeof window.edenSocial.createSocialShareButtons === 'function') {
                    window.edenSocial.createSocialShareButtons(shareContainer);
                    
                    const shareButtons = shareContainer.querySelectorAll('.share-btn');
                    if (shareButtons.length > 0) {
                        testResults.shareButtons = true;
                        updateStatus('shareButtonResults', 'pass', `${shareButtons.length} share buttons generated successfully`);
                        logTest(`✓ Generated ${shareButtons.length} social share buttons`, 'success');
                    } else {
                        testResults.shareButtons = false;
                        updateStatus('shareButtonResults', 'fail', 'No share buttons generated');
                        logTest('✗ No share buttons were generated', 'error');
                    }
                } else {
                    testResults.shareButtons = false;
                    updateStatus('shareButtonResults', 'fail', 'Share button function not available');
                    logTest('✗ Share button function not found', 'error');
                }
            } catch (error) {
                testResults.shareButtons = false;
                updateStatus('shareButtonResults', 'fail', `Error: ${error.message}`);
                logTest(`✗ Share buttons error: ${error.message}`, 'error');
            }
        }

        // Test 3: Instagram Guide
        function testInstagramGuide() {
            logTest('Testing Instagram guide modal...', 'info');
            
            try {
                if (window.edenSocial && typeof window.edenSocial.showInstagramGuide === 'function') {
                    window.edenSocial.showInstagramGuide();
                    testResults.instagramGuide = true;
                    updateStatus('instagramGuideStatus', 'pass', 'Instagram guide opened successfully');
                    logTest('✓ Instagram guide modal opened', 'success');
                    
                    // Auto-close after 3 seconds for testing
                    setTimeout(() => {
                        const modal = document.querySelector('.social-guide-modal');
                        if (modal) modal.remove();
                        logTest('Instagram guide modal auto-closed for testing', 'info');
                    }, 3000);
                } else {
                    testResults.instagramGuide = false;
                    updateStatus('instagramGuideStatus', 'fail', 'Instagram guide function not available');
                    logTest('✗ Instagram guide function not found', 'error');
                }
            } catch (error) {
                testResults.instagramGuide = false;
                updateStatus('instagramGuideStatus', 'fail', `Error: ${error.message}`);
                logTest(`✗ Instagram guide error: ${error.message}`, 'error');
            }
        }

        // Test 4: TikTok Guide
        function testTikTokGuide() {
            logTest('Testing TikTok guide modal...', 'info');
            
            try {
                if (window.edenSocial && typeof window.edenSocial.showTikTokGuide === 'function') {
                    window.edenSocial.showTikTokGuide();
                    testResults.tiktokGuide = true;
                    updateStatus('tiktokGuideStatus', 'pass', 'TikTok guide opened successfully');
                    logTest('✓ TikTok guide modal opened', 'success');
                    
                    // Auto-close after 3 seconds for testing
                    setTimeout(() => {
                        const modal = document.querySelector('.social-guide-modal');
                        if (modal) modal.remove();
                        logTest('TikTok guide modal auto-closed for testing', 'info');
                    }, 3000);
                } else {
                    testResults.tiktokGuide = false;
                    updateStatus('tiktokGuideStatus', 'fail', 'TikTok guide function not available');
                    logTest('✗ TikTok guide function not found', 'error');
                }
            } catch (error) {
                testResults.tiktokGuide = false;
                updateStatus('tiktokGuideStatus', 'fail', `Error: ${error.message}`);
                logTest(`✗ TikTok guide error: ${error.message}`, 'error');
            }
        }

        // Test 5: Analytics Tracking
        function testAnalyticsTracking() {
            logTest('Testing analytics tracking...', 'info');
            
            try {
                if (window.edenSocial && typeof window.edenSocial.trackEvent === 'function') {
                    // Test different event types
                    window.edenSocial.trackEvent('page_view', 'test-page');
                    window.edenSocial.trackEvent('social_click', 'test-page', 'instagram');
                    window.edenSocial.trackEvent('time_spent', 'test-page', null, 30000);
                    window.edenSocial.trackEvent('scroll_depth', 'test-page', null, 0.75);
                    
                    testResults.analytics = true;
                    updateStatus('analyticsResults', 'pass', 'Analytics tracking functions working');
                    logTest('✓ Analytics tracking test passed', 'success');
                } else {
                    testResults.analytics = false;
                    updateStatus('analyticsResults', 'fail', 'Analytics tracking not available');
                    logTest('✗ Analytics tracking function not found', 'error');
                }
            } catch (error) {
                testResults.analytics = false;
                updateStatus('analyticsResults', 'fail', `Error: ${error.message}`);
                logTest(`✗ Analytics tracking error: ${error.message}`, 'error');
            }
        }

        function simulateUserInteraction() {
            logTest('Simulating user interactions...', 'info');
            
            // Simulate various user events
            if (window.edenSocial) {
                window.edenSocial.trackEvent('page_view', 'test-page');
                window.edenSocial.trackEvent('social_share', 'test-page', 'facebook');
                window.edenSocial.trackEvent('social_share', 'test-page', 'instagram');
                window.edenSocial.trackEvent('social_click', 'test-page', 'tiktok');
                
                logTest('✓ Simulated page view, shares, and clicks', 'success');
            }
        }

        function checkAnalyticsData() {
            logTest('Checking analytics data...', 'info');
            // This would normally fetch from the backend API
            logTest('Analytics data check completed (mock)', 'info');
        }

        // Test 6: API Endpoints
        async function testAPIEndpoints() {
            logTest('Testing backend API endpoints...', 'info');
            updateStatus('apiResults', 'pending', 'Testing API endpoints...');
            
            try {
                const baseUrl = window.location.origin;
                const endpoints = [
                    '/api/social/analytics',
                    '/api/social/share-counts',
                    '/api/social/trending',
                    '/api/social/dashboard'
                ];
                
                let passedTests = 0;
                let totalTests = endpoints.length;
                
                for (const endpoint of endpoints) {
                    try {
                        const response = await fetch(`${baseUrl}${endpoint}`);
                        if (response.ok) {
                            passedTests++;
                            logTest(`✓ ${endpoint} - OK`, 'success');
                        } else {
                            logTest(`✗ ${endpoint} - ${response.status}`, 'error');
                        }
                    } catch (error) {
                        logTest(`✗ ${endpoint} - ${error.message}`, 'error');
                    }
                }
                
                if (passedTests === totalTests) {
                    testResults.api = true;
                    updateStatus('apiResults', 'pass', `All ${totalTests} API endpoints working`);
                    logTest('✓ All API endpoints test passed', 'success');
                } else {
                    testResults.api = false;
                    updateStatus('apiResults', 'fail', `${passedTests}/${totalTests} API endpoints working`);
                    logTest(`✗ ${totalTests - passedTests} API endpoints failed`, 'error');
                }
            } catch (error) {
                testResults.api = false;
                updateStatus('apiResults', 'fail', `API test error: ${error.message}`);
                logTest(`✗ API test error: ${error.message}`, 'error');
            }
        }

        async function testShareCounts() {
            logTest('Testing share counts API...', 'info');
            
            try {
                const response = await fetch('/api/social/share-counts');
                const data = await response.json();
                
                if (response.ok && data.success) {
                    logTest(`✓ Share counts: Instagram ${data.data.followers.instagram}, Facebook ${data.data.followers.facebook}`, 'success');
                } else {
                    logTest(`✗ Share counts API failed`, 'error');
                }
            } catch (error) {
                logTest(`✗ Share counts error: ${error.message}`, 'error');
            }
        }

        async function testAnalyticsAPI() {
            logTest('Testing analytics API...', 'info');
            
            try {
                // Test tracking event
                const trackResponse = await fetch('/api/social/analytics/track', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        eventType: 'page_view',
                        page: 'test-page',
                        timestamp: Date.now()
                    })
                });
                
                if (trackResponse.ok) {
                    logTest('✓ Analytics tracking API working', 'success');
                } else {
                    logTest('✗ Analytics tracking API failed', 'error');
                }
                
                // Test getting analytics
                const analyticsResponse = await fetch('/api/social/analytics');
                const analyticsData = await analyticsResponse.json();
                
                if (analyticsResponse.ok && analyticsData.success) {
                    logTest(`✓ Analytics retrieval: ${analyticsData.data.summary.totalPageViews} page views`, 'success');
                } else {
                    logTest('✗ Analytics retrieval API failed', 'error');
                }
            } catch (error) {
                logTest(`✗ Analytics API error: ${error.message}`, 'error');
            }
        }

        // Test 7: Responsive Design
        function testResponsiveDesign() {
            logTest('Testing responsive design...', 'info');
            
            const floatingBar = document.querySelector('.eden-floating-social');
            const shareButtons = document.querySelectorAll('.share-btn');
            
            if (floatingBar && shareButtons.length > 0) {
                testResults.responsive = true;
                updateStatus('responsiveResults', 'pass', 'Responsive elements found and working');
                logTest('✓ Responsive design test passed', 'success');
            } else {
                testResults.responsive = false;
                updateStatus('responsiveResults', 'fail', 'Some responsive elements missing');
                logTest('✗ Responsive design test failed', 'error');
            }
        }

        function simulateMobileView() {
            document.body.style.width = '375px';
            logTest('Simulated mobile view (375px width)', 'info');
            setTimeout(() => {
                document.body.style.width = '';
                logTest('Restored original view', 'info');
            }, 3000);
        }

        function simulateTabletView() {
            document.body.style.width = '768px';
            logTest('Simulated tablet view (768px width)', 'info');
            setTimeout(() => {
                document.body.style.width = '';
                logTest('Restored original view', 'info');
            }, 3000);
        }

        // Utility Functions
        function clearTestLog() {
            document.getElementById('testLog').innerHTML = '<div>Test log cleared</div>';
        }

        function runAllTests() {
            logTest('Running complete test suite...', 'info');
            
            // Run all tests in sequence
            setTimeout(() => testFloatingSocialBar(), 500);
            setTimeout(() => testSocialSharing(), 1000);
            setTimeout(() => testInstagramGuide(), 1500);
            setTimeout(() => testTikTokGuide(), 2000);
            setTimeout(() => testAnalyticsTracking(), 2500);
            setTimeout(() => testAPIEndpoints(), 3000);
            setTimeout(() => testResponsiveDesign(), 4000);
            setTimeout(() => updateTestSummary(), 5000);
        }

        function updateTestSummary() {
            const passed = Object.values(testResults).filter(result => result === true).length;
            const failed = Object.values(testResults).filter(result => result === false).length;
            const total = Object.keys(testResults).length;
            
            const summaryElement = document.getElementById('testSummary');
            
            if (passed === total) {
                summaryElement.innerHTML = `<div class="status pass">All ${total} tests passed! 🎉</div>`;
                logTest(`✓ TEST SUITE COMPLETE: All ${total} tests passed!`, 'success');
            } else {
                summaryElement.innerHTML = `
                    <div class="status ${failed > 0 ? 'fail' : 'pass'}">
                        ${passed}/${total} tests passed, ${failed} failed
                    </div>
                `;
                logTest(`TEST SUITE COMPLETE: ${passed}/${total} passed, ${failed} failed`, failed > 0 ? 'error' : 'success');
            }
        }

        // Initialize tests on page load
        document.addEventListener('DOMContentLoaded', function() {
            logTest('Social Media Integration Test Suite loaded', 'info');
            logTest('Click "Run All Tests" to start comprehensive testing', 'info');
        });
    </script>
</body>
</html>